<!DOCTYPE html>
<html>
	<head>
		<title>Demo</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://unpkg.com/leaflet@0.7.7/dist/leaflet.css" />
		<script src="https://unpkg.com/leaflet@0.7.7/dist/leaflet.js"></script>
		<!-- Leaflet Labels -->
		<link href="Leaflet.label/dist/leaflet.label.css" rel="stylesheet" />
		<script src="Leaflet.label/dist/leaflet.label.js"></script>
		<script src="https://d3js.org/d3.v4.js"></script>
		<style>
			#map {
				position: absolute; 
				top: 0; 
				left: 0;
				width: 100%;
				height: 100%;
			}
		</style>
	</head>
	<body>
		<div id="map"></div>
	</body>
	<link rel="stylesheet" href='L.AnimationSvgMarker.css' />		
	<script src='L.AnimationSvgMarker.js'></script>
	<script>

		var map, marker;
		// var radius = 20;
		var radius = 50;

		document.addEventListener('DOMContentLoaded', function() {
		   init();
		});

		function init() {

			var defaultLayer =  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
				attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
				reuseTiles: true
			});

			var baseLayers = { 
				"OpenStreetMap": L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
					attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
					reuseTiles: true
				}),
				"Esri_DarkGrey": L.tileLayer('https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}', {
					attribution: 'Esri, HERE, DeLorme, MapmyIndia, Â© OpenStreetMap contributors, and the GIS user community',
					reuseTiles: true,
					maxZoom: 16
				})
			}

			map = L.map('map',{
				maxZoom:20,
				layers: [
					defaultLayer
				]
			}).setView([0,0], 2)

			marker = L.animationsvgmarker(map.getCenter(), {
				timestamp: new Date().getTime(),
				color: "#FF0000"
			});

			// Colors of the rainbow
			var rainbow = [
				"#9400D3", // Violet
				"#4B0082", // Indigo
				"#0000FF", // Blue
				"#00FF00", // Green
				"#FFFF00", // Yellow
				"#FF7F00", // Orange
				"#FF0000"  // Red
			];

			setTimeout(function(){
				marker.addToFadeIn(map);
				function animate(angle) {
					if (angle%100 == 0) {
						var n = Math.floor((Math.random() * rainbow.length));
						marker.changeColor(rainbow[n],1500);
					}
					setTimeout(function(){
						marker.moveTo(
							L.latLng(
								Math.cos(angle/100) * radius, 
								Math.sin(angle/100) * radius
							), 25);
						animate(angle+1);
					}, 25);
				}
				animate(1);
			}, 1250);

		}

	</script>	
</html>

